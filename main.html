<html>
<head>
 <meta charset='utf-8' />
 <script src='data2.json' ></script>
 <script>
var $ = function(id){
	return document.getElementById(id);
};
function dumpData()
{
	$('dump').innerHTML = JSON.stringify(data);
}
var SURROGATE_PAIR_START = 0xd800;
var SURROGATE_PAIR_END = 0xdbff;
function onSave(obj)
{
	obj.innerHTML = obj.children[0].value;
	var key = obj.parentElement.children[0].innerHTML;
	data[key] = new Array();
	for (var i = 0; i != obj.innerHTML.length; ++i)
	{
		var codevalue = obj.innerHTML.charCodeAt(i);
		if (codevalue >= SURROGATE_PAIR_START && codevalue <= SURROGATE_PAIR_END)
		{
			data[key].push(obj.innerHTML[i] + obj.innerHTML[++i]);
		}
		else  data[key].push(obj.innerHTML[i]);
	}

	dumpData();
	
}
var g_last_obj;
function f(obj)
{
	if (obj.innerHTML[0] != '<')
	{
		if (g_last_obj) onSave(g_last_obj);
		var ori_data = obj.innerHTML;
		obj.innerHTML = "<input value=\"" + ori_data + "\" />"
		obj.children[0].select();
		g_last_obj = obj;
	}
	else {
		onSave(obj);
		g_last_obj = null;
	}
}
 </script>
</head>
<body>
<button id='save' >save</button>
<table id='main' border='1' cellSpacing='0'>
</table>
<pre id='dump'></pre>
</body>
<script>
// onload
// generate table
var ret = "<tr><th>汉字</th><th>拆分</th></tr>";
for (var key in data)
{
	ret += "<tr>";
	ret += "<td>" + key + "</td>";
	ret += "<td ondblclick = \"f(this)\" >";

	for (var j = 0; j != data[key].length; ++j)
	{
		ret += data[key][j];
	}

	ret += "</td>";
	ret += "</tr>";
}
$("main").innerHTML = ret;
$("save").onclick = function(){

};
</script>
<html>
